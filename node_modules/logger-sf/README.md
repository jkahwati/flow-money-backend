# LOGGER-SF

**¿Qué es este Repositorio?**

Librería con formato Estandar de Seguros Falabella para Loggear en artefactos NodeJS (Javascript ó Typescript)


**¿Cómo se configura?**

- Agregar en el package.json del artefacto consumidor la siguiente linea:

```bash
"logger-sf": "git+ssh://git@bitbucket.org/segurosfalabella/logger-sf.git#loggerDevelopment",
```

- Configurar el pipeline de la siguiente manera:

```bash
  - name: build
    image: segurosfalabella.azurecr.io/sf/node-dev:10-latest
    environment:
      PRIVATE_KEY:
        from_secret: private_key
      PUBLIC_KEY:
        from_secret: public_key
    commands:
      - apk add --update python python-dev make build-base
      - apk add git openssh-client --no-cache
      - mkdir $HOME/.ssh && chmod 0700 $HOME/.ssh
      - ssh-keyscan bitbucket.org > /root/.ssh/known_hosts
      - echo "$PRIVATE_KEY" > /root/.ssh/id_rsa && echo "$PUBLIC_KEY" > /root/.ssh/id_rsa.pub
      - chmod 600 $HOME/.ssh/id_rsa && chmod 600 $HOME/.ssh/id_rsa.pub

```
Esto con el fin de agregar la llave publica y privada SSH al contenedor para poder bajar la libreria del repositorio de bitbucket del paso anterior


- Solicitar al equipo Chile Back Office o Arquitectura crear  llave publica y privada para consumo:

 - Agregar en drone los secretos de la siguiente manera:

```bash
private_key: <private_key>
public_key: <public_key>
```

 - Por ultimo instalar

```bash
npm install
```

Actualmente se puede loggear con info y error de la siguiente manera:

```bash
const {logger, InfoLog, ErrorLog} = require('logger-sf')

logger.info(new InfoLog().withMessage("Validating Healh"))

logger.error(new InfoLog().withMessage("Message Error"))
```

Las posibles opciones del builder hasta ahora son:

```bash
.withCommerce()
.withCountry()
.withEnvironment()
.withDetails()
.withLevel()
.withMessage()
.withProduct()
.withTraceID()
```

Para finalmente seguir el formato estandar actual de Seguros Falabella:

https://segurosfalabella.atlassian.net/wiki/spaces/CDA/pages/558792843/Est+ndar+de+Logging





**API Core Chile Owner:**
**Líder Ágil:** Angelina Abreu
**Desarrolladores:** Jesús Kahwati y José Ortiz